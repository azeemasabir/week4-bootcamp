{% extends "layout.html" %}
{% block content %}
<h1 class="mb-4">Reports</h1>

<!-- Filter Form -->
<form class="row g-2 mb-4" method="get" action="{{ url_for('report') }}">
  <div class="col-auto">
    <label class="form-label">Month:</label>
    <input type="month" name="month" value="{{ selected_month }}" class="form-control">
  </div>
  <div class="col-auto d-flex align-items-end">
    <button type="submit" class="btn btn-primary me-2">Show</button>
    <a class="btn btn-outline-secondary" href="{{ url_for('report') }}">Reset</a>
  </div>
</form>

<!-- Charts -->
<div class="charts">
  <div class="chart-card">
    <h3 class="h5 mb-3">ðŸ“‚ Spending by Category</h3>
    <canvas id="catChart"></canvas>
  </div>
  <div class="chart-card">
    <h3 class="h5 mb-3">ðŸ“… Daily Spending</h3>
    <canvas id="dailyChart"></canvas>
  </div>
</div>

<script>
  // Category Pie
  const catCtx = document.getElementById('catChart').getContext('2d');
  new Chart(catCtx, {
    type: 'pie',
    data: {
      labels: {{ labels|tojson }},
      datasets: [{
        data: {{ values|tojson }},
        backgroundColor: ['#4e73df','#1cc88a','#36b9cc','#f6c23e','#e74a3b','#858796']
      }]
    }
  });

  // Daily Line
  const dailyCtx = document.getElementById('dailyChart').getContext('2d');
  new Chart(dailyCtx, {
    type: 'line',
    data: {
      labels: {{ daily_labels|tojson }},
      datasets: [{
        label: 'Amount',
        data: {{ daily_values|tojson }},
        borderColor: '#4e73df',
        backgroundColor: 'rgba(78, 115, 223, 0.1)',
        tension: 0.3,
        fill: true
      }]
    }
  });
</script>
{% endblock %}
